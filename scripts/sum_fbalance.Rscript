#!/usr/bin/Rscript --vanilla

library(plyr)
library(doParallel)

registerDoParallel()

args <- commandArgs(TRUE)

input_csv <- args[1]
output_csv <- args[2]

fbalance <- read.csv(args[1])

sum_fbalance <- ddply(fbalance, .(language, spec_id), 
                    summarize, sum_fbalance=sum(balance),
                    .parallel=T)

write.csv(sum_fbalance, file=args[2], row.names=F)

