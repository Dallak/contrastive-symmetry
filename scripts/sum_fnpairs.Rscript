#!/usr/bin/Rscript --vanilla

library(plyr)
library(doParallel)

registerDoParallel()

args <- commandArgs(TRUE)

input_csv <- args[1]
output_csv <- args[2]

fnpairs <- read.csv(args[1])

sum_fnpairs <- ddply(fnpairs, .(language, spec_id), 
                    summarize, sum_fnpairs=sum(pair_count),
                    .parallel=T)

write.csv(sum_fnpairs, file=args[2], row.names=F)
